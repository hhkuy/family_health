<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz Application</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        .quiz-container {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 80%;
            max-width: 900px;
            margin-bottom: 20px;
        }

        h1 {
            text-align: center;
            color: #343a40;
            font-size: 32px;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .question-container {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #dee2e6;
            position: relative;
        }

        .question {
            font-size: 18px;
            margin-bottom: 10px;
            color: #495057;
            display: flex;
            align-items: flex-start;
        }

        .question-number {
            color: #000000;
            font-weight: bold;
            margin-right: 10px;
        }

        .lightbulb-icon {
            margin-left: 5px;
            cursor: pointer;
            font-size: 16px;
            color: #ffc107;
        }

        .explanation {
            display: none;
            margin-top: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background-color: #e2e3e5;
            border-left: 5px solid #6c757d;
            color: #343a40;
            border-radius: 5px;
        }

        .options-container {
            margin-bottom: 10px;
            margin-top: 10px;
        }

        .option {
            display: flex;
            align-items: center;
            background-color: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            transition: background-color 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .option:hover {
            background-color: #e9ecef;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .option input {
            margin-right: 15px;
            cursor: pointer;
        }

        .option label {
            flex-grow: 1;
            cursor: pointer;
        }

        .correct {
            background-color: #28a745 !important;
            color: white;
        }

        .wrong {
            background-color: #dc3545 !important;
            color: white;
        }

        .unanswered {
            background-color: #ffc107 !important;
            color: black;
        }

        .correct-answer {
            background-color: #28a745 !important;
            color: white;
            border: 2px solid #28a745;
        }

        button {
            padding: 12px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            margin-top: 15px;
            width: 100%;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        #filter-btn {
            background-color: #007bff;
            color: #fff;
            margin-bottom: 20px;
        }

        #filter-btn:hover {
            background-color: #0056b3;
        }

        #shuffle-questions {
            background-color: #007bff;
            color: white;
        }

        #shuffle-questions:hover {
            background-color: #0056b3;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #shuffle-options {
            background-color: #007bff;
            color: white;
        }

        #shuffle-options:hover {
            background-color: #0056b3;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #show-result {
            background-color: #28a745;
            color: white;
        }

        #show-result:hover {
            background-color: #218838;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #reset-quiz {
            background-color: #dc3545;
            color: white;
        }

        #reset-quiz:hover {
            background-color: #c82333;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #switch-mode {
            background-color: #6f42c1; 
            color: white;
            margin-bottom: 20px; 
        }

        #switch-mode:hover {
            background-color: #5a3791;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #result {
            font-size: 18px;
            margin-top: 20px;
            text-align: center;
            color: #343a40;
        }

        .floating-button-container {
            position: fixed !important;
            top: 80px !important;
            right: 20px !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 9999 !important;
        }

        .floating-button {
            background-color: #007bff;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }

        .floating-button:hover {
            background-color: #0056b3;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 200;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 400px;
            text-align: center;
        }

        .modal-button {
            padding: 10px 20px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }

        .modal-button.yes {
            background-color: #28a745;
            color: #fff;
        }

        .modal-button.no {
            background-color: #dc3545;
            color: #fff;
        }

        .show-answer-button, .clear-button, .shuffle-options-button {
            padding: 8px 12px;
            margin-top: 10px;
            font-size: 14px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            width: auto;
            margin-right: 5px;
        }

        .show-answer-button {
            background-color: #28a745;
            color: white;
        }

        .show-answer-button:hover {
            background-color: #218838;
        }

        .shuffle-options-button {
            background-color: #007bff;
            color: white;
        }

        .shuffle-options-button:hover {
            background-color: #0056b3;
        }

        .clear-button {
            background-color: #dc3545;
            color: white;
        }

        .clear-button:hover {
            background-color: #c82333;
        }

        .filter-button {
            padding: 12px;
            margin: 5px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
        }

        .filter-button.correct {
            background-color: #28a745;
        }

        .filter-button.wrong {
            background-color: #dc3545;
        }

        .filter-button.unanswered {
            background-color: #ffc107;
            color: black;
        }

        .filter-button.all {
            background-color: #007bff;
        }

        #search-results {
            max-height: 300px;
            overflow-y: auto;
            padding: 0;
            list-style-type: none;
            margin-top: 20px;
            text-align: left;
        }

        #search-results ul {
            padding: 0;
            list-style-type: none;
            margin: 0;
        }

        #search-results li {
            margin: 10px 0;
        }
        
        #jump-input {
            width: 300px;
            height: 20px;
            font-size: 16px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ced4da;
        }

        #jump-input:focus {
            outline: none;
            border-color: #80bdff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }

        #search-results li button {
            width: 100%;
            text-align: left;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            background-color: #f8f9fa;
            transition: background-color 0.3s;
        }

        #search-results li button:hover {
            background-color: #e9ecef;
        }

        #search-results li button mark {
            background-color: yellow;
        }

        .answer {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background-color: #e2e3e5;
            border-left: 5px solid #6c757d;
            color: #343a40;
            border-radius: 5px;
            direction: ltr;
            text-align: left;
        }

        .is-correct {
            margin-top: 10px;
            font-size: 14px;
            color: #495057;
            direction: ltr;
            text-align: left;
        }

        .yes-no-group {
            margin-top: 5px;
            display: flex;
            align-items: center;
            direction: ltr;
            justify-content: flex-start;
        }

        .yes-no-group button {
            padding: 4px 8px;
            margin-right: 10px;
            font-size: 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .yes-button {
            background-color: #28a745;
            color: white;
        }

        .yes-button:hover {
            background-color: #218838;
        }

        .no-button {
            background-color: #dc3545;
            color: white;
        }

        .no-button:hover {
            background-color: #c82333;
        }

        .filter-button.yes-button {
            background-color: #28a745;
            color: white;
        }

        .filter-button.yes-button:hover {
            background-color: #218838;
        }

        .filter-button.no-button {
            background-color: #dc3545;
            color: white;
        }

        .filter-button.no-button:hover {
            background-color: #c82333;
        }

        .filter-button.unanswered-button {
            background-color: #ffc107;
            color: black;
        }

        .filter-button.unanswered-button:hover {
            background-color: #e0a800;
        }

        .filter-button.all-button {
            background-color: #007bff;
            color: white;
        }

        .filter-button.all-button:hover {
            background-color: #0056b3;
        }

        .modal-content select {
            width: 80%;
            max-width: 300px;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ced4da;
            background: #fff;
            display: block;
            margin: 0 auto;
        }

        .modal-content select:focus {
            outline: none;
            border-color: #80bdff;
            box-shadow: 0 0 3px rgba(0,123,255,.5);
        }

        .category-modal-buttons {
            display: flex;
            justify-content: center;
            margin-top: 15px;
        }

        .category-modal-buttons button {
            margin: 0 5px;
        }

    </style>
</head>
<body>
    <div class="quiz-container" id="quiz-container">
        <h1>Family Health Questions</h1>
        
        <p>Total Questions: <strong id="total-questions"></strong></p>
        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <button id="filter-btn" onclick="openCategoryModal()">Filter Categories</button>
            <button id="switch-mode" onclick="switchMode()">Switch to Flashcard Mode</button>
        </div>
        
        <form id="quiz-form">
            <!-- Questions will be injected here -->
        </form>
        <button id="shuffle-questions" onclick="shuffleVisibleQuestions()">Shuffle Questions</button>
        <button id="shuffle-options" onclick="shuffleAllOptions()">Shuffle Options</button>
        <button id="show-result" onclick="showResult()">Show Result</button>
        <button id="reset-quiz" onclick="resetQuiz()">Reset Quiz</button>
        <div id="result"></div>
    </div>

    <div class="floating-button-container">
        <button id="scroll-button" class="floating-button" onclick="handleScrollButton()" title="Scroll between answered and bottom">↓</button>
        <button id="jump-button" class="floating-button" onclick="openJumpModal()" title="Search Questions">🔍</button>
    </div>

    <div id="reset-modal" class="modal">
        <div class="modal-content">
            <p>Are you sure you want to reset the quiz?</p>
            <button class="modal-button yes" onclick="confirmResetQuiz()">Yes</button>
            <button class="modal-button no" onclick="closeResetModal()">No</button>
        </div>
    </div>

    <div id="jump-modal" class="modal">
        <div class="modal-content">
            <p>Search in currently displayed questions:</p>
            <input type="text" id="jump-input" placeholder="Enter keyword...">
            <button class="modal-button" onclick="jumpToQuestion()">Search</button>
            <button class="modal-button no" onclick="closeJumpModal()">Close</button>
            <div id="search-results"></div>
        </div>
    </div>

    <div id="category-modal" class="modal">
        <div class="modal-content">
            <p>Select Categories:</p>
            <select id="category-filter" multiple></select>
            <div class="category-modal-buttons">
                <button id="select-all-categories-btn" style="padding:8px; font-size:14px; border-radius:5px; border:none; background-color:#007bff; color:#fff; cursor:pointer;">Select/Unselect All</button>
                <button class="modal-button yes" onclick="applyCategoryFilter()">OK</button>
                <button class="modal-button no" onclick="closeCategoryModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
    let quizData = [
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 1</span> What is a core unit of health services that influences individual and community health?",
        "options": [
            "Hospitals",
            "Schools",
            "Family",
            "Clinics"
        ],
        "answer": 2,
        "answerText": "Family",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 2</span> Which of the following is NOT a type of family?",
        "options": [
            "Nuclear",
            "Cohabitating",
            "Stepfamily",
            "Industrial"
        ],
        "answer": 3,
        "answerText": "Industrial",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 3</span> What influences family health?",
        "options": [
            "Cultural factors",
            "Gender roles",
            "Economic status",
            "All of the above"
        ],
        "answer": 3,
        "answerText": "All of the above",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 4</span> Which of these is NOT part of the Calgary Family Assessment Model (CFAM)?",
        "options": [
            "Genograms",
            "Community mapping",
            "Ecomaps",
            "Structural and functional assessment"
        ],
        "answer": 1,
        "answerText": "Community mapping",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 5</span> What is a characteristic of a healthy family?",
        "options": [
            "Strong communication",
            "Limited adaptability",
            "Emotional distance",
            "Isolation from the community"
        ],
        "answer": 0,
        "answerText": "Strong communication",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 6</span> Which of the following describes tertiary family-focused interventions?",
        "options": [
            "Health promotion and safety education",
            "Crisis intervention and linking families to services",
            "Support for families with long-term health issues and grief",
            "Screening for diseases in families"
        ],
        "answer": 2,
        "answerText": "Support for families with long-term health issues and grief",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 7</span> What is the primary significance of marriage in society?",
        "options": [
            "Enhancing individual wealth",
            "Maintaining societal stability",
            "Preventing diseases",
            "Ensuring genetic diversity"
        ],
        "answer": 1,
        "answerText": "Maintaining societal stability",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 8</span> What does premarital health counseling NOT typically include?",
        "options": [
            "Immunizations like Rubella",
            "Screening for genetic conditions",
            "Financial planning advice",
            "Family planning counseling"
        ],
        "answer": 2,
        "answerText": "Financial planning advice",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 9</span> Which stage of George Levinger’s ABCDE model involves developing trust and communication?",
        "options": [
            "Attraction",
            "Building",
            "Continuity",
            "Deterioration"
        ],
        "answer": 1,
        "answerText": "Building",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 10</span> Which is NOT a factor of readiness for marriage?",
        "options": [
            "Financial independence",
            "Social maturity",
            "Family background",
            "Professional success"
        ],
        "answer": 3,
        "answerText": "Professional success",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 11</span> How does premarital education and counseling benefit couples?",
        "options": [
            "It eliminates relationship conflicts entirely.",
            "It improves marital satisfaction and stability.",
            "It guarantees financial success.",
            "It prevents all genetic disorders."
        ],
        "answer": 1,
        "answerText": "It improves marital satisfaction and stability.",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 12</span> What does the \"E\" in the ABCDE model stand for?",
        "options": [
            "Engagement",
            "Ending",
            "Evaluation",
            "Exploration"
        ],
        "answer": 1,
        "answerText": "Ending",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 13</span> What marks the start of puberty in girls?",
        "options": [
            "Growth spurt",
            "Menarche",
            "Breast development",
            "Hormonal changes"
        ],
        "answer": 1,
        "answerText": "Menarche",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 14</span> Which part of the brain develops earlier during adolescence, influencing emotions and risky behaviors?",
        "options": [
            "Prefrontal cortex",
            "Limbic system",
            "Hippocampus",
            "Cerebellum"
        ],
        "answer": 1,
        "answerText": "Limbic system",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 15</span> What is a common consequence of early maturation in boys?",
        "options": [
            "Increased aggression",
            "Low self-esteem",
            "Poor academic performance",
            "Lack of physical growth"
        ],
        "answer": 0,
        "answerText": "Increased aggression",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 16</span> Which eating disorder involves self-starvation due to fear of weight gain?",
        "options": [
            "Bulimia nervosa",
            "Anorexia nervosa",
            "Binge-eating disorder",
            "Orthorexia"
        ],
        "answer": 1,
        "answerText": "Anorexia nervosa",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 17</span> What are secondary sexual characteristics?",
        "options": [
            "Organs directly involved in reproduction",
            "Visible changes like breast and beard growth",
            "Hormonal shifts in the endocrine system",
            "Brain development affecting emotions"
        ],
        "answer": 1,
        "answerText": "Visible changes like breast and beard growth",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 18</span> What can family meals during childhood help reduce?",
        "options": [
            "Early maturation",
            "Risky sexual behavior",
            "Eating disorders",
            "Sleep disturbances"
        ],
        "answer": 2,
        "answerText": "Eating disorders",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 19</span> What are social determinants of health (SDH)?",
        "options": [
            "Genetic factors influencing health outcomes",
            "Economic and social conditions shaping health",
            "Environmental changes affecting ecosystems",
            "Technological advances in healthcare"
        ],
        "answer": 1,
        "answerText": "Economic and social conditions shaping health",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 20</span> What does health equity aim to achieve?",
        "options": [
            "Eliminating all diseases",
            "Equal health outcomes for everyone",
            "Addressing only medical conditions",
            "Ensuring the wealthiest access health services first"
        ],
        "answer": 1,
        "answerText": "Equal health outcomes for everyone",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 21</span> Which of these is NOT a social determinant of equity?",
        "options": [
            "Capitalism",
            "Gender roles",
            "Race",
            "Natural disasters"
        ],
        "answer": 3,
        "answerText": "Natural disasters",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 22</span> What does tackling social determinants of health require?",
        "options": [
            "Collaboration across multiple sectors",
            "Focusing solely on hospital care",
            "Ignoring historical injustices",
            "Increasing healthcare costs"
        ],
        "answer": 0,
        "answerText": "Collaboration across multiple sectors",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 23</span> Which level of health intervention focuses on improving population health by addressing SDH?",
        "options": [
            "Medical care",
            "Primary prevention",
            "Tertiary care",
            "Community events"
        ],
        "answer": 1,
        "answerText": "Primary prevention",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 24</span> What is an example of inequity?",
        "options": [
            "Equal distribution of healthcare resources",
            "Systematic disadvantages for certain communities",
            "Eradication of social disparities",
            "Equal employment opportunities for all"
        ],
        "answer": 1,
        "answerText": "Systematic disadvantages for certain communities",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 25</span> What is the primary goal of domestic violence?",
        "options": [
            "Financial gain",
            "Maintaining power and control",
            "Resolving conflicts",
            "Establishing emotional balance"
        ],
        "answer": 1,
        "answerText": "Maintaining power and control",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 26</span> Which of the following is NOT a type of domestic violence?",
        "options": [
            "Physical violence",
            "Psychological violence",
            "Intellectual violence",
            "Financial violence"
        ],
        "answer": 2,
        "answerText": "Intellectual violence",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 27</span> Which phase in the cycle of violence involves apologies and promises?",
        "options": [
            "Tension-building",
            "Explosion",
            "Honeymoon phase",
            "Recurrence phase"
        ],
        "answer": 2,
        "answerText": "Honeymoon phase",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 28</span> According to the CDC report (2017-2018), what percentage of women experienced sexual coercion?",
        "options": [
            "10.9%",
            "23.6%",
            "47.6%",
            "52%"
        ],
        "answer": 1,
        "answerText": "23.6%",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 29</span> What is a key step in the protocol for rape management?",
        "options": [
            "Delay treatment until police approval",
            "Avoid documenting injuries",
            "Emergency contraception within 72 hours",
            "Skip psychological counseling"
        ],
        "answer": 2,
        "answerText": "Emergency contraception within 72 hours",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 30</span> What is an example of financial violence?",
        "options": [
            "Humiliation and insults",
            "Preventing access to money",
            "Threats of physical harm",
            "Groping without consent"
        ],
        "answer": 1,
        "answerText": "Preventing access to money",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 31</span> What is the primary cause of sexual dysfunction?",
        "options": [
            "Only physical issues",
            "Only psychological issues",
            "Physical, psychological, and social factors",
            "Cultural beliefs alone"
        ],
        "answer": 2,
        "answerText": "Physical, psychological, and social factors",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 32</span> Which phase of the sexual response cycle involves relaxation?",
        "options": [
            "Desire",
            "Excitement",
            "Orgasm",
            "Resolution"
        ],
        "answer": 3,
        "answerText": "Resolution",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 33</span> Which disorder is classified under paraphilias?",
        "options": [
            "Impotence",
            "Voyeurism",
            "Frigidity",
            "Erectile dysfunction"
        ],
        "answer": 1,
        "answerText": "Voyeurism",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 34</span> What is the most common treatment for gender identity disorders?",
        "options": [
            "Hormonal imbalances correction",
            "Psychoanalysis",
            "Psychotherapy or sex reassignment surgery",
            "Aversion therapy"
        ],
        "answer": 2,
        "answerText": "Psychotherapy or sex reassignment surgery",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 35</span> Which is NOT a type of sexual dysfunction?",
        "options": [
            "Frigidity",
            "Dyspareunia",
            "Necrophilia",
            "Impotence"
        ],
        "answer": 2,
        "answerText": "Necrophilia",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 36</span> What is a biological treatment for paraphilias?",
        "options": [
            "Aversion therapy",
            "Hormone therapy to reduce libido",
            "Cognitive restructuring",
            "Behavioral counseling"
        ],
        "answer": 1,
        "answerText": "Hormone therapy to reduce libido",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 37</span> What hormone in contraceptives suppresses ovulation?",
        "options": [
            "Progestin",
            "Estrogen",
            "Testosterone",
            "Cortisol"
        ],
        "answer": 1,
        "answerText": "Estrogen",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 38</span> Which contraceptive option is effective for up to 10 years?",
        "options": [
            "Hormonal IUD",
            "Copper IUD",
            "Vaginal ring",
            "Transdermal patch"
        ],
        "answer": 1,
        "answerText": "Copper IUD",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 39</span> What is an advantage of the transdermal patch?",
        "options": [
            "Protects against STIs",
            "Weekly application",
            "No risk of skin reactions",
            "Unlimited weight compatibility"
        ],
        "answer": 1,
        "answerText": "Weekly application",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 40</span> Which method relies on tracking ovulation?",
        "options": [
            "Sterilization",
            "Lactational Amenorrhea Method (LAM)",
            "Fertility awareness",
            "Emergency contraception"
        ],
        "answer": 2,
        "answerText": "Fertility awareness",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 41</span> What is a contraindication for combined hormonal contraceptives?",
        "options": [
            "Age under 18",
            "Cardiovascular disease",
            "Physical activity",
            "Vegetarian diet"
        ],
        "answer": 1,
        "answerText": "Cardiovascular disease",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 42</span> Which emergency contraception method is effective up to 5 days after intercourse?",
        "options": [
            "Plan B",
            "Copper IUD",
            "Ulipristal (Ella)",
            "Levonorgestrel"
        ],
        "answer": 1,
        "answerText": "Copper IUD",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 43</span> What is the critical period for fetal organ development?",
        "options": [
            "1–3 weeks post-fertilization",
            "4–10 weeks post-fertilization",
            "11–15 weeks post-fertilization",
            "16–20 weeks post-fertilization"
        ],
        "answer": 1,
        "answerText": "4–10 weeks post-fertilization",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 44</span> What does preconception care aim to improve?",
        "options": [
            "Fertility rates",
            "Knowledge and health before conception",
            "Lifespan of infants",
            "Maternal age at conception"
        ],
        "answer": 1,
        "answerText": "Knowledge and health before conception",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 45</span> Which of the following is NOT included in preconception counseling?",
        "options": [
            "Smoking cessation",
            "Genetic screening",
            "Career counseling",
            "Nutrition evaluation"
        ],
        "answer": 2,
        "answerText": "Career counseling",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 46</span> Which test is recommended during preconception care?",
        "options": [
            "MRI scan",
            "Hematocrit",
            "X-ray imaging",
            "Blood pressure test only"
        ],
        "answer": 1,
        "answerText": "Hematocrit",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 47</span> What is the recommended daily folic acid intake for women planning pregnancy?",
        "options": [
            "100 μg",
            "400 μg",
            "1000 μg",
            "10 mg"
        ],
        "answer": 1,
        "answerText": "400 μg",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 48</span> What is the main benefit of rubella vaccination in preconception care?",
        "options": [
            "Prevents miscarriage",
            "Prevents congenital rubella syndrome",
            "Enhances fertility",
            "Reduces maternal weight gain"
        ],
        "answer": 1,
        "answerText": "Prevents congenital rubella syndrome",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 49</span> What is the primary goal of prenatal care?",
        "options": [
            "Ensuring a healthy and normal pregnancy",
            "Providing postnatal care for the baby",
            "Preventing maternal employment",
            "Promoting medication use"
        ],
        "answer": 0,
        "answerText": "Ensuring a healthy and normal pregnancy",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 50</span> How many antenatal visits are recommended during pregnancy for optimal care?",
        "options": [
            "4 visits",
            "10 visits",
            "13 visits",
            "15 visits"
        ],
        "answer": 2,
        "answerText": "13 visits",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 51</span> Which supplementation is recommended to prevent neural tube defects during pregnancy?",
        "options": [
            "Iron",
            "Calcium",
            "Folic acid",
            "Vitamin D"
        ],
        "answer": 2,
        "answerText": "Folic acid",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 52</span> What is the purpose of a first-trimester ultrasound?",
        "options": [
            "Fetal presentation",
            "Crown-rump length for gestational age",
            "Monitoring fetal movements",
            "Checking fetal heart rate in the second trimester"
        ],
        "answer": 1,
        "answerText": "Crown-rump length for gestational age",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 53</span> Which vaccine is contraindicated during pregnancy?",
        "options": [
            "Tetanus toxoid",
            "Hepatitis vaccine",
            "Rubella (live virus)",
            "Influenza vaccine"
        ],
        "answer": 2,
        "answerText": "Rubella (live virus)",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 54</span> What should pregnant women avoid during the later stages of pregnancy?",
        "options": [
            "Protein intake",
            "Rest and sleep",
            "Supine position and heavy lifting",
            "Light physical activity"
        ],
        "answer": 2,
        "answerText": "Supine position and heavy lifting",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 55</span> What is the primary adaptation of the cardiovascular system during pregnancy?",
        "options": [
            "Decreased blood volume",
            "Increased cardiac output and blood volume",
            "Decreased heart rate",
            "Elevated blood pressure"
        ],
        "answer": 1,
        "answerText": "Increased cardiac output and blood volume",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 56</span> Which hormone helps prepare the uterus for implantation?",
        "options": [
            "Estrogen",
            "Progesterone",
            "Oxytocin",
            "Prolactin"
        ],
        "answer": 1,
        "answerText": "Progesterone",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 57</span> Which change occurs in the respiratory system during pregnancy?",
        "options": [
            "Reduced oxygen consumption",
            "Decreased tidal volume",
            "Diaphragm elevation and hyperventilation",
            "Slower respiratory rate"
        ],
        "answer": 2,
        "answerText": "Diaphragm elevation and hyperventilation",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 58</span> Which is NOT a common gastrointestinal issue during pregnancy?",
        "options": [
            "Nausea and vomiting",
            "Diarrhea",
            "Heartburn",
            "Constipation"
        ],
        "answer": 1,
        "answerText": "Diarrhea",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 59</span> What is the total recommended weight gain during pregnancy for a woman with a normal BMI?",
        "options": [
            "5–7 kg",
            "11.5–16 kg",
            "20–25 kg",
            "17–20 kg"
        ],
        "answer": 1,
        "answerText": "11.5–16 kg",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 60</span> Which test detects pregnancy earliest?",
        "options": [
            "Urine test",
            "Blood test",
            "Ultrasound",
            "Physical examination"
        ],
        "answer": 1,
        "answerText": "Blood test",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 61</span> What marks the transition from the first to the second stage of labor?",
        "options": [
            "Onset of uterine contractions",
            "Full cervical dilation (10 cm)",
            "Delivery of the placenta",
            "Rupture of membranes"
        ],
        "answer": 1,
        "answerText": "Full cervical dilation (10 cm)",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 62</span> What is the first step of the mechanisms of labor?",
        "options": [
            "Descent",
            "Engagement",
            "Flexion",
            "Restitution"
        ],
        "answer": 1,
        "answerText": "Engagement",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 63</span> Which factor is NOT part of the \"3 Ps\" influencing labor?",
        "options": [
            "Passenger (fetus)",
            "Power (contractions)",
            "Position of the mother",
            "Passage (pelvis and soft tissues)"
        ],
        "answer": 2,
        "answerText": "Position of the mother",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 64</span> Which pelvic type is most favorable for vaginal delivery?",
        "options": [
            "Gynaecoid",
            "Android",
            "Anthropoid",
            "Platypelloid"
        ],
        "answer": 0,
        "answerText": "Gynaecoid",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 65</span> What is the purpose of controlled cord traction during the third stage of labor?",
        "options": [
            "Initiate uterine contractions",
            "Facilitate placental expulsion",
            "Relieve maternal discomfort",
            "Prevent fetal distress"
        ],
        "answer": 1,
        "answerText": "Facilitate placental expulsion",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 66</span> What is an indication for induction of labor?",
        "options": [
            "Fetal malpresentation",
            "Postmaturity",
            "Normal fetal position",
            "Uterine anomalies"
        ],
        "answer": 1,
        "answerText": "Postmaturity",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 67</span> Which indicator is used to measure child mortality rates?",
        "options": [
            "Growth charts",
            "Neonatal mortality rate",
            "Vaccination coverage",
            "Developmental milestones"
        ],
        "answer": 1,
        "answerText": "Neonatal mortality rate",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 68</span> Which growth principle describes head-to-toe development in children?",
        "options": [
            "Proximodistal",
            "Cephalocaudal",
            "Symmetrical",
            "Peripheral"
        ],
        "answer": 1,
        "answerText": "Cephalocaudal",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 69</span> What is the primary cause of diarrhea in children globally?",
        "options": [
            "Poor hygiene",
            "Malnutrition",
            "Viral and bacterial infections",
            "Lack of vaccination"
        ],
        "answer": 2,
        "answerText": "Viral and bacterial infections",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 70</span> What is emphasized in newborn care immediately after delivery?",
        "options": [
            "Immunization schedule",
            "Maintaining body temperature",
            "Initiating solid foods",
            "Routine ultrasound"
        ],
        "answer": 1,
        "answerText": "Maintaining body temperature",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 71</span> Which stage of growth and development is characterized by rapid growth spurts?",
        "options": [
            "Infancy",
            "Adolescence",
            "Toddlerhood",
            "Early childhood"
        ],
        "answer": 0,
        "answerText": "Infancy",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 72</span> Which vaccine prevents rubella?",
        "options": [
            "DTaP",
            "Hepatitis B",
            "MMR",
            "Polio"
        ],
        "answer": 2,
        "answerText": "MMR",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 73</span> What age range defines the \"young-old\" category of elders?",
        "options": [
            "55–65 years",
            "65–75 years",
            "75–85 years",
            "85–100 years"
        ],
        "answer": 1,
        "answerText": "65–75 years",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 74</span> What is a common characteristic of elders over 85 years old?",
        "options": [
            "Higher levels of employment",
            "Increased life spans and rapid population growth",
            "Minimal healthcare needs",
            "Decreased risk of poverty"
        ],
        "answer": 1,
        "answerText": "Increased life spans and rapid population growth",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 75</span> What does ageism refer to?",
        "options": [
            "Increased healthcare services for elders",
            "Negative stereotypes and discrimination based on age",
            "Policies that prioritize elder care",
            "Advocacy for gerontology research"
        ],
        "answer": 1,
        "answerText": "Negative stereotypes and discrimination based on age",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 76</span> What is the focus of geriatrics?",
        "options": [
            "Financial planning for retirees",
            "Social and recreational activities for elders",
            "Medical care and health challenges of older adults",
            "Nutritional guidance for seniors"
        ],
        "answer": 2,
        "answerText": "Medical care and health challenges of older adults",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 77</span> Which of the following is a common physical change associated with aging?",
        "options": [
            "Increased joint flexibility",
            "Reduced visual acuity",
            "Enhanced immune response",
            "Decreased susceptibility to chronic illnesses"
        ],
        "answer": 1,
        "answerText": "Reduced visual acuity",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 78</span> What is an example of secondary prevention in elder care?",
        "options": [
            "Rehabilitation after a stroke",
            "Screening for dementia and cancer",
            "Encouraging social participation",
            "Promoting lifelong healthy habits"
        ],
        "answer": 1,
        "answerText": "Screening for dementia and cancer",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 79</span> Which rehabilitation strategy involves family and community support?",
        "options": [
            "Economic rehabilitation",
            "Psychological rehabilitation",
            "Social rehabilitation",
            "Physical rehabilitation"
        ],
        "answer": 2,
        "answerText": "Social rehabilitation",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>File Questions - Question 80</span> How can social activities benefit elders?",
        "options": [
            "By isolating them for reflection",
            "By increasing stress levels",
            "By reducing stress and enhancing well-being",
            "By limiting their community involvement"
        ],
        "answer": 2,
        "answerText": "By reducing stress and enhancing well-being",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 1</span> Preconceptional care involves which of the following domains?",
        "options": [
            "Only medical intervention",
            "Only behavioral intervention",
            "Only social intervention",
            "None of the above"
        ],
        "answer": 3,
        "answerText": "None of the above",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 2</span> Which of the following is NOT a goal of preconceptional care?",
        "options": [
            "Improvement of knowledge, attitudes, and behaviors of women",
            "Treatment of chronic disease in women",
            "Treatment of chronic disease in the fetus",
            "All of the above"
        ],
        "answer": 2,
        "answerText": "Treatment of chronic disease in the fetus",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 3</span> When is NOT the optimal time to provide preconceptional care?",
        "options": [
            "Premarital office visit",
            "Postpartum office visit",
            "After a positive pregnancy test",
            "Contraception counseling"
        ],
        "answer": 2,
        "answerText": "After a positive pregnancy test",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 4</span> Which women are susceptible to unintended pregnancy?",
        "options": [
            "Older than 45 years",
            "Younger than 20 years",
            "Between 20–45 years",
            "All women in the reproductive age group"
        ],
        "answer": 3,
        "answerText": "All women in the reproductive age group",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 5</span> What vaccine can be injected in preconceptional care but NOT during pregnancy?",
        "options": [
            "Hepatitis B",
            "Tetanus toxoid (TT)",
            "Rubella",
            "Influenza"
        ],
        "answer": 2,
        "answerText": "Rubella",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 6</span> Which screening is suggested during preconceptional care?",
        "options": [
            "Rubella serology",
            "Hepatitis C serology",
            "Varicella serology",
            "A & C"
        ],
        "answer": 3,
        "answerText": "A & C",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 7</span> Which vitamin can have a teratogenic effect on the fetus?",
        "options": [
            "Vitamin A",
            "Vitamin B",
            "Vitamin C",
            "Vitamin D"
        ],
        "answer": 0,
        "answerText": "Vitamin A",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 8</span> What amount of folic acid is suggested for pregnant women without any risk of neural tube defects (NTD)?",
        "options": [
            "300 mcg",
            "200 mcg",
            "400 mcg",
            "500 mcg"
        ],
        "answer": 2,
        "answerText": "400 mcg",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 9</span> Which women should be referred to a nutritionist before pregnancy?",
        "options": [
            "Infertile women",
            "Obese women",
            "Women with hypothyroidism",
            "Women with hyperthyroidism"
        ],
        "answer": 1,
        "answerText": "Obese women",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 10</span> Which women must be vaccinated for Hepatitis B in a preconception visit?",
        "options": [
            "All women",
            "Women already affected by Hepatitis B",
            "High-risk women",
            "None of the women"
        ],
        "answer": 2,
        "answerText": "High-risk women",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 11</span> A pregnant woman’s last menstrual period (LMP) was on 12/5. What is her estimated gestational age (GA) and estimated due date (EDD)?",
        "options": [
            "9/12",
            "4/1",
            "5/12",
            "9/18"
        ],
        "answer": 0,
        "answerText": "9/12",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 12</span> What does the term \"sexual disorder\" refer to?",
        "options": [
            "A lack of interest in physical activity",
            "Difficulty in any stage of normal sexual activity",
            "An inability to engage in romantic relationships",
            "Preference for same-sex relationships"
        ],
        "answer": 1,
        "answerText": "Difficulty in any stage of normal sexual activity",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 13</span> What is the first phase of the sexual response cycle?",
        "options": [
            "Excitement",
            "Orgasm",
            "Desire",
            "Resolution"
        ],
        "answer": 2,
        "answerText": "Desire",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 14</span> During which phase of the sexual response cycle do increased heart rate and blood flow to the genitals occur?",
        "options": [
            "Desire",
            "Excitement",
            "Orgasm",
            "Resolution"
        ],
        "answer": 1,
        "answerText": "Excitement",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 15</span> Which of the following best describes transsexualism?",
        "options": [
            "A strong preference for cross-dressing without gender dysphoria",
            "Discomfort regarding one’s anatomical sex and a feeling that it does not match one’s perceived gender",
            "Sexual arousal from wearing clothing associated with the opposite sex",
            "A condition affecting individuals with physical characteristics of both sexes"
        ],
        "answer": 1,
        "answerText": "Discomfort regarding one’s anatomical sex and a feeling that it does not match one’s perceived gender",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 16</span> Individuals diagnosed with intersexuality typically have which of the following conditions?",
        "options": [
            "They exhibit typical sexual characteristics of one gender only",
            "They have anatomical or physical features of both sexes",
            "They experience no discomfort regarding their gender identity",
            "They are exclusively attracted to individuals of their assigned gender"
        ],
        "answer": 1,
        "answerText": "They have anatomical or physical features of both sexes",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 17</span> Liam has always felt different from his peers. From a young age, he expressed discomfort with his anatomical sex, feeling that it did not align with his true gender identity. He often daydreamed about living as a girl and wished he could undergo surgery to transition. Liam finds it difficult to relate to his current gender and often feels unhappy in his body. What condition does Liam likely identify with?",
        "options": [
            "Dual-role transsexualism",
            "Gender identity disorder of childhood",
            "Transsexualism",
            "Intersexuality"
        ],
        "answer": 2,
        "answerText": "Transsexualism",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 18</span> Sophie is an 8-year-old girl who prefers playing with trucks and insists on wearing boys' clothing. She expresses a desire to grow up as a boy and is unhappy when called by her given name. Sophie’s parents are concerned but do not know how to address her feelings about her gender identity, especially since she has shown these behaviors consistently since early childhood. What condition might Sophie be experiencing?",
        "options": [
            "Sexual arousal disorder",
            "Intersexuality",
            "Gender identity disorder of childhood",
            "Dual-role transsexualism"
        ],
        "answer": 2,
        "answerText": "Gender identity disorder of childhood",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 19</span> Alex, a 28-year-old man, has been in a committed relationship with Jamie for two years. However, Alex often finds himself attracted primarily to men. He has had occasional sexual experiences with women, but those encounters usually don’t excite him as much as his experiences with men do. How would you classify Alex's sexual orientation based on his experiences?",
        "options": [
            "Obligatory homosexuality",
            "Preferred homosexuality",
            "Bisexuality",
            "Latent homosexuality"
        ],
        "answer": 2,
        "answerText": "Bisexuality",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 20</span> Carmen is a 35-year-old woman who has been exploring her sexuality. Although she has only had relationships with men, she sometimes fantasizes about being with women. Carmen feels comfortable identifying as heterosexual, but her fantasies suggest there might be more to her sexual identity. She has never acted on these fantasies in any way. What term best describes Carmen's sexual orientation regarding her fantasies?",
        "options": [
            "Obligatory homosexuality",
            "Preferred homosexuality",
            "Bisexuality",
            "Latent homosexuality"
        ],
        "answer": 3,
        "answerText": "Latent homosexuality",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 21</span> What is NOT a disadvantage of combined hormonal contraceptives?",
        "options": [
            "Increased risk of ovarian cancer",
            "Nausea",
            "Breast tenderness",
            "Headache"
        ],
        "answer": 0,
        "answerText": "Increased risk of ovarian cancer",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 22</span> In the case that a woman is susceptible to hypercoagulation, which of the following contraceptive methods is forbidden?",
        "options": [
            "Female condom",
            "Progestin-only tablet",
            "IUD",
            "Combined hormonal contraceptives"
        ],
        "answer": 3,
        "answerText": "Combined hormonal contraceptives",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 23</span> Which of the following is a contraindication for using combined hormonal contraceptives?",
        "options": [
            "Mild hypertension",
            "Family history of thrombophilias",
            "Occasional migraines without aura",
            "Irregular menses"
        ],
        "answer": 1,
        "answerText": "Family history of thrombophilias",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 24</span> In which of the following conditions is Progestin-Only Contraception NOT completely contraindicated?",
        "options": [
            "Venous thrombosis",
            "Vascular disease",
            "Hypertension",
            "Vaginal dryness"
        ],
        "answer": 3,
        "answerText": "Vaginal dryness",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 25</span> In the situation of cancer treatment, which method can be used?",
        "options": [
            "Depo-Provera",
            "Mini pills",
            "IUD",
            "Combined hormonal methods"
        ],
        "answer": 0,
        "answerText": "Depo-Provera",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 26</span> In the case of dysmenorrhea and heavy bleeding, which method of family planning can be used?",
        "options": [
            "Copper IUD",
            "Mirena",
            "Combined hormonal methods",
            "Mini pills"
        ],
        "answer": 1,
        "answerText": "Mirena",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 27</span> Alex and Jamie have decided to rely on withdrawal as their primary method of contraception. They have discussed the importance of timing and communication during intercourse. One evening, during intercourse, Alex remembers to withdraw before ejaculation. What is a potential benefit they experience by using this method effectively?",
        "options": [
            "It guarantees pregnancy prevention.",
            "It is always available and incurs no costs.",
            "It provides complete protection against STDs.",
            "It does not require any discussion between partners."
        ],
        "answer": 1,
        "answerText": "It is always available and incurs no costs.",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 28</span> Which one is part of the methods of fertility awareness?",
        "options": [
            "Progestin-only",
            "Breast milk",
            "Combined hormonal method",
            "Symptothermal (BBT + cervical)"
        ],
        "answer": 3,
        "answerText": "Symptothermal (BBT + cervical)",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 29</span> In the case of migraines, which contraception method is the best?",
        "options": [
            "Combined hormonal method",
            "Progestin-only",
            "Mini pill",
            "Condom"
        ],
        "answer": 3,
        "answerText": "Condom",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 30</span> In the case of hypertension, which contraception method is the best?",
        "options": [
            "Combined hormonal method",
            "Progestin-only",
            "Condom",
            "Abstinence"
        ],
        "answer": 2,
        "answerText": "Condom",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 31</span> What is the definition of rape as outlined by the World Health Organization?",
        "options": [
            "Any coercion for sexual favor",
            "Physically forced or otherwise coerced penetration of the vulva or anus",
            "Flirting (kissing) without consent",
            "Touching in a sexual way"
        ],
        "answer": 1,
        "answerText": "Physically forced or otherwise coerced penetration of the vulva or anus",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 32</span> Which of the following is considered sexual harassment?",
        "options": [
            "Any coercion for sexual favor",
            "Physically forced or otherwise coerced penetration of the vulva or anus",
            "Flirting (kissing) without consent",
            "Touching in a sexual way"
        ],
        "answer": 0,
        "answerText": "Any coercion for sexual favor",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 33</span> Which of the following is NOT a component of a healthy relationship?",
        "options": [
            "Respect",
            "Control",
            "Equality",
            "Trust and support"
        ],
        "answer": 1,
        "answerText": "Control",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 34</span> What is emphasized in the \"Actions That Feel Safe\" section?",
        "options": [
            "Openly judging each other",
            "Ensuring both partners feel secure in communication and actions",
            "Dominating decisions",
            "Avoiding discussions"
        ],
        "answer": 1,
        "answerText": "Ensuring both partners feel secure in communication and actions",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 35</span> During an argument, Mia's partner starts shouting at her, calling her derogatory names and belittling her in front of friends. This behavior is an example of:",
        "options": [
            "Sexual abuse",
            "Financial abuse",
            "Emotional abuse",
            "Physical abuse"
        ],
        "answer": 2,
        "answerText": "Emotional abuse",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 36</span> Jake regularly withholds money from his partner, preventing them from making decisions about their own finances or purchasing necessary items. This scenario illustrates:",
        "options": [
            "Physical abuse",
            "Sexual abuse",
            "Psychological abuse",
            "Financial abuse"
        ],
        "answer": 3,
        "answerText": "Financial abuse",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 37</span> Sarah is in a relationship where her partner often showers her with affection and promises. However, over time, she begins to notice small arguments turning into verbal disagreements. Sarah feels like she’s \"walking on eggshells\" to avoid conflicts. What stage of the cycle of violence is Sarah experiencing when her partner apologizes and shows affection?",
        "options": [
            "Violence",
            "Tension",
            "Honeymoon",
            "Escalation"
        ],
        "answer": 2,
        "answerText": "Honeymoon",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 38</span> During a physical examination for a suspected case of sexual assault, which of the following is an essential step for the examiner?",
        "options": [
            "Focus solely on the pelvic area without considering the rest of the body.",
            "Only document visible injuries and ignore any negative findings.",
            "Visualize the entire body and note all abnormalities, including old and new trauma.",
            "Conduct the examination without speaking to the patient about their history."
        ],
        "answer": 2,
        "answerText": "Visualize the entire body and note all abnormalities, including old and new trauma.",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 39</span> What is a key determinant of health related to income?",
        "options": [
            "Access to healthy food",
            "Age",
            "Physical activity",
            "Sex"
        ],
        "answer": 0,
        "answerText": "Access to healthy food",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 40</span> What impact does social support have on health?",
        "options": [
            "It has a negative effect on health",
            "It has no effect on health",
            "It reduces stress and improves health outcomes",
            "It only affects mental health"
        ],
        "answer": 2,
        "answerText": "It reduces stress and improves health outcomes",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 41</span> Which demographic factor is often associated with disparities in health?",
        "options": [
            "Educational attainment",
            "Hair color",
            "Favorite food",
            "Homeownership"
        ],
        "answer": 0,
        "answerText": "Educational attainment",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 42</span> Which of the following is likely to be a barrier to healthcare access?",
        "options": [
            "Having health insurance",
            "Living in a rural area",
            "Having a regular doctor",
            "Access to public transportation"
        ],
        "answer": 1,
        "answerText": "Living in a rural area",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 43</span> How does neighborhood safety influence health?",
        "options": [
            "Unsafe neighborhoods promote physical activity",
            "Safety has no effect on health",
            "Unsafe neighborhoods can lead to anxiety and limited outdoor activities",
            "Safety only affects mental health"
        ],
        "answer": 2,
        "answerText": "Unsafe neighborhoods can lead to anxiety and limited outdoor activities",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 44</span> What is the relationship between socioeconomic status (SES) and health?",
        "options": [
            "Higher SES typically correlates with worse health outcomes",
            "SES has no impact on health",
            "Lower SES is often linked to poorer health outcomes",
            "All socioeconomic groups have the same health outcomes"
        ],
        "answer": 2,
        "answerText": "Lower SES is often linked to poorer health outcomes",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 45</span> What is a significant consequence of failing to address social determinants of health?",
        "options": [
            "Improved health equity",
            "Widening health disparities",
            "Decreased healthcare costs",
            "Increased public health awareness"
        ],
        "answer": 1,
        "answerText": "Widening health disparities",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 46</span> Which of the following best describes \"equality\"?",
        "options": [
            "Providing the same resources or opportunities to everyone",
            "Distributing resources based on individual needs",
            "Ensuring everyone has access to what they specifically require",
            "Recognizing and addressing systemic barriers to achieve fairness"
        ],
        "answer": 2,
        "answerText": "Ensuring everyone has access to what they specifically require",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 47</span> How does \"equity\" differ from \"equality\"?",
        "options": [
            "Equity treats everyone the same regardless of their circumstances",
            "Equity focuses on fairness and addresses individual needs and circumstances",
            "Equity is less important than equality",
            "Equity means giving everyone the same outcome"
        ],
        "answer": 1,
        "answerText": "Equity focuses on fairness and addresses individual needs and circumstances",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 48</span> At what age do most girls typically begin menstruation?",
        "options": [
            "8-10 years",
            "11-13 years",
            "14-16 years",
            "17-19 years"
        ],
        "answer": 1,
        "answerText": "11-13 years",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 49</span> What is the primary hormone responsible for male puberty changes?",
        "options": [
            "Estrogen",
            "Testosterone",
            "Progesterone",
            "Insulin"
        ],
        "answer": 1,
        "answerText": "Testosterone",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 50</span> What emotional change is often experienced during puberty?",
        "options": [
            "Increased happiness",
            "Mood swings",
            "Decreased sensitivity",
            "Constant calmness"
        ],
        "answer": 1,
        "answerText": "Mood swings",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 51</span> Which of the following behaviors may indicate a teenager is struggling with emotional well-being during puberty?",
        "options": [
            "Increased socializing",
            "Withdrawal from friends and family",
            "Developing new hobbies",
            "Becoming more dependent"
        ],
        "answer": 1,
        "answerText": "Withdrawal from friends and family",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 52</span> What typically triggers the onset of puberty?",
        "options": [
            "Increased physical activity",
            "Hormonal changes in the body",
            "Changes in diet",
            "Stressful life events"
        ],
        "answer": 1,
        "answerText": "Hormonal changes in the body",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 53</span> What role do parents play in their teenager's experience of puberty?",
        "options": [
            "None; teenagers need total independence",
            "They should avoid discussing changes",
            "They can provide support and guidance",
            "They only interfere with personal growth"
        ],
        "answer": 2,
        "answerText": "They can provide support and guidance",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 54</span> At what age do most boys typically experience puberty?",
        "options": [
            "9-14",
            "8-12",
            "7-12",
            "16-18"
        ],
        "answer": 3,
        "answerText": "16-18",
        "explanation": "null",
        "userAnswer": null
    },
    {
        "question": "<span style='color: darkred; font-weight: bold;'>TBL Questions - Question 55</span> Which one is correct?",
        "options": [
            "Limbic system & amygdala develop after frontal cortex development",
            "Limbic system & amygdala develop before frontal cortex development",
            "Thelarche happens after menarche",
            "Pubarche happens after menarche"
        ],
        "answer": 1,
        "answerText": "Limbic system & amygdala develop before frontal cortex development",
        "explanation": "null",
        "userAnswer": null
    }
];

    let originalQuizData = JSON.parse(JSON.stringify(quizData));

    // إضافة الدالة المفقودة toggleExplanation
    function toggleExplanation(index) {
        const explanationDiv = document.getElementById(`explanation-${index}`);
        if (explanationDiv.style.display === 'none' || explanationDiv.style.display === '') {
            explanationDiv.style.display = 'block';
        } else {
            explanationDiv.style.display = 'none';
        }
    }

    // We will store categories from originalQuizData to avoid them being affected by shuffling
    let originalCategories = [];
    function initOriginalCategories() {
        const cats = originalQuizData.map(q => extractCategoryFromQuestion(q.question)).filter(c => c);
        originalCategories = [...new Set(cats)];
    }

    const quizForm = document.getElementById('quiz-form');
    const resultElement = document.getElementById('result');
    const scrollButton = document.getElementById('scroll-button');
    let scrollState = 0;

    let lastAnsweredIndex = -1;
    let mode = 'mcq'; 
    let currentCorrectnessFilter = 'all';
    let categoryFilterSelected = [];

    function switchMode() {
        if (mode === 'mcq') {
            mode = 'flashcard';
            document.getElementById('switch-mode').textContent = 'Switch to MCQs Mode';
            document.getElementById('shuffle-options').style.display = 'none'; 
        } else {
            mode = 'mcq';
            document.getElementById('switch-mode').textContent = 'Switch to Flashcards Mode';
            document.getElementById('shuffle-options').style.display = 'inline-block'; 
        }
        loadQuiz();
        resultElement.innerHTML = '';
        currentCorrectnessFilter = 'all';
        applyAllFilters();
    }

    function loadQuiz() {
        const fragment = document.createDocumentFragment();
        quizData.forEach((data, index) => {
            const questionContainer = document.createElement('div');
            questionContainer.classList.add('question-container');
            questionContainer.id = `question-container-${index}`;

            const questionDiv = document.createElement('div');
            questionDiv.classList.add('question');
            questionDiv.id = `question-${index}`;

            const questionNumberSpan = document.createElement('span');
            questionNumberSpan.classList.add('question-number');
            questionNumberSpan.textContent = `${index + 1}.`;

            const questionTextSpan = document.createElement('span');
            questionTextSpan.innerHTML = data.question;

            const lightbulbIcon = document.createElement('span');
            lightbulbIcon.classList.add('lightbulb-icon');
            lightbulbIcon.innerHTML = '💡';
            lightbulbIcon.dataset.index = index;
            lightbulbIcon.addEventListener('click', () => {
                toggleExplanation(index);
            });

            questionDiv.appendChild(questionNumberSpan);
            questionDiv.appendChild(questionTextSpan);
            questionDiv.appendChild(lightbulbIcon);
            questionContainer.appendChild(questionDiv);

            const explanationDiv = document.createElement('div');
            explanationDiv.classList.add('explanation');
            explanationDiv.id = `explanation-${index}`;
            explanationDiv.textContent = data.explanation || '';
            questionContainer.appendChild(explanationDiv);

            if (mode === 'mcq') {
                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('options-container');
                optionsContainer.id = `options-container-${index}`;

                data.options.forEach((option, optionIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.classList.add('option');
                    optionDiv.dataset.index = index;
                    optionDiv.dataset.optionIndex = optionIndex;

                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.id = `question-${index}-option-${optionIndex}`;
                    radioInput.name = `question-${index}`;
                    radioInput.value = optionIndex;
                    optionDiv.appendChild(radioInput);

                    const optionLabel = document.createElement('label');
                    optionLabel.textContent = option;
                    optionDiv.appendChild(optionLabel);

                    optionsContainer.appendChild(optionDiv);
                });

                questionContainer.appendChild(optionsContainer);

                const showAnswerButton = document.createElement('button');
                showAnswerButton.type = 'button';
                showAnswerButton.textContent = 'Show Answer';
                showAnswerButton.classList.add('show-answer-button');
                showAnswerButton.dataset.index = index;
                showAnswerButton.addEventListener('click', () => {
                    showIndividualAnswer(index);
                });

                const shuffleOptionsButton = document.createElement('button');
                shuffleOptionsButton.type = 'button';
                shuffleOptionsButton.textContent = 'Shuffle Options';
                shuffleOptionsButton.classList.add('shuffle-options-button');
                shuffleOptionsButton.dataset.index = index;
                shuffleOptionsButton.addEventListener('click', () => {
                    shuffleOptionsForQuestion(index);
                });

                const clearButton = document.createElement('button');
                clearButton.type = 'button';
                clearButton.textContent = 'Clear';
                clearButton.classList.add('clear-button');
                clearButton.dataset.index = index;
                clearButton.addEventListener('click', () => {
                    clearIndividualQuestion(index);
                });

                const buttonContainer = document.createElement('div');
                buttonContainer.appendChild(showAnswerButton);
                buttonContainer.appendChild(shuffleOptionsButton);
                buttonContainer.appendChild(clearButton);

                questionContainer.appendChild(buttonContainer);
            } else if (mode === 'flashcard') {
                const buttonGroup = document.createElement('div');
                buttonGroup.classList.add('button-group');

                const showAnswerButton = document.createElement('button');
                showAnswerButton.type = 'button';
                showAnswerButton.textContent = 'Show Answer';
                showAnswerButton.classList.add('show-answer-button');
                showAnswerButton.dataset.index = index;
                showAnswerButton.addEventListener('click', () => {
                    toggleAnswer(index);
                });

                const clearButton = document.createElement('button');
                clearButton.type = 'button';
                clearButton.textContent = 'Clear';
                clearButton.classList.add('clear-button');
                clearButton.dataset.index = index;
                clearButton.addEventListener('click', () => {
                    clearUserAnswer(index);
                });

                const indicator = document.createElement('span');
                indicator.classList.add('indicator');
                indicator.id = `indicator-${index}`;

                buttonGroup.appendChild(showAnswerButton);
                buttonGroup.appendChild(clearButton);
                buttonGroup.appendChild(indicator);

                questionContainer.appendChild(buttonGroup);

                const answerDiv = document.createElement('div');
                answerDiv.classList.add('answer');
                answerDiv.id = `answer-${index}`;
                answerDiv.textContent = data.answerText ? `Answer: ${data.answerText}` : '';
                questionContainer.appendChild(answerDiv);

                const isCorrectDiv = document.createElement('div');
                isCorrectDiv.classList.add('is-correct');
                isCorrectDiv.textContent = 'Is your answer correct?';
                questionContainer.appendChild(isCorrectDiv);

                const yesNoGroup = document.createElement('div');
                yesNoGroup.classList.add('yes-no-group');

                const yesButton = document.createElement('button');
                yesButton.type = 'button';
                yesButton.textContent = 'Yes';
                yesButton.classList.add('yes-button');
                yesButton.dataset.index = index;
                yesButton.addEventListener('click', () => {
                    setUserAnswer(index, 'yes');
                });

                const noButton = document.createElement('button');
                noButton.type = 'button';
                noButton.textContent = 'No';
                noButton.classList.add('no-button');
                noButton.dataset.index = index;
                noButton.addEventListener('click', () => {
                    setUserAnswer(index, 'no');
                });

                yesNoGroup.appendChild(yesButton);
                yesNoGroup.appendChild(noButton);

                questionContainer.appendChild(yesNoGroup);
            }

            fragment.appendChild(questionContainer);
        });

        quizForm.innerHTML = '';
        quizForm.appendChild(fragment);

        document.getElementById('total-questions').textContent = quizData.length;
    }

    quizForm.addEventListener('click', (event) => {
        const target = event.target;
        if (mode === 'mcq') {
            if (target.matches('.option, .option *')) {
                let optionDiv = target.closest('.option');
                const radioInput = optionDiv.querySelector('input[type="radio"]');
                if (!radioInput.checked) {
                    radioInput.checked = true;
                }
                const index = parseInt(radioInput.name.split('-')[1]);
                scrollState = 0;
                lastAnsweredIndex = index;
                updateScrollButtonIcon();
            }
        }
    });

    function handleScrollButton() {
        if (lastAnsweredIndex === -1) {
            if (scrollState === 0 || scrollState === 2) {
                window.scrollTo({top: document.body.scrollHeight,behavior: 'smooth'});
                scrollState = 3;
            } else if (scrollState === 3) {
                window.scrollTo({top: 0,behavior: 'smooth'});
                scrollState = 2;
            }
        } else {
            if (scrollState === 0) {
                document.getElementById(`question-${lastAnsweredIndex}`).scrollIntoView({ behavior: 'smooth' });
                scrollState = 1;
            } else if (scrollState === 1) {
                window.scrollTo({top: document.body.scrollHeight,behavior: 'smooth'});
                scrollState = 2;
            } else if (scrollState === 2) {
                document.getElementById(`question-${lastAnsweredIndex}`).scrollIntoView({ behavior: 'smooth' });
                scrollState = 3;
            } else if (scrollState === 3) {
                window.scrollTo({top: 0,behavior: 'smooth'});
                scrollState = 1;
            }
        }
        updateScrollButtonIcon();
    }

    function updateScrollButtonIcon() {
        if (lastAnsweredIndex === -1) {
            if (scrollState === 0 || scrollState === 2) {
                scrollButton.textContent = '↓';
            } else if (scrollState === 3) {
                scrollButton.textContent = '↑';
            }
        } else {
            if (scrollState === 0) {
                scrollButton.textContent = '⇄';
            } else if (scrollState === 1) {
                scrollButton.textContent = '↓';
            } else if (scrollState === 2) {
                scrollButton.textContent = '⇄';
            } else if (scrollState === 3) {
                scrollButton.textContent = '↑';
            }
        }
    }

    function shuffleOptionsForQuestion(index) {
        const data = quizData[index];
        const optionsContainer = document.getElementById(`options-container-${index}`);
        if (!optionsContainer) return;
        const selectedInput = optionsContainer.querySelector('input:checked');
        const selectedOptionIndex = selectedInput ? parseInt(selectedInput.value) : null;

        const currentOptions = data.options.map((option, i) => ({ option, index: i }));
        const shuffledOptions = shuffleArray(currentOptions);

        data.options = shuffledOptions.map(o => o.option);
        data.answer = shuffledOptions.findIndex(o => o.index === data.answer);

        const fragment = document.createDocumentFragment();

        data.options.forEach((option, optionIndex) => {
            const optionDiv = document.createElement('div');
            optionDiv.classList.add('option');
            optionDiv.dataset.index = index;
            optionDiv.dataset.optionIndex = optionIndex;

            const radioInput = document.createElement('input');
            radioInput.type = 'radio';
            radioInput.id = `question-${index}-option-${optionIndex}`;
            radioInput.name = `question-${index}`;
            radioInput.value = optionIndex;

            if (optionIndex === selectedOptionIndex) {
                radioInput.checked = true;
            }

            optionDiv.appendChild(radioInput);

            const optionLabel = document.createElement('label');
            optionLabel.textContent = option;
            optionDiv.appendChild(optionLabel);

            fragment.appendChild(optionDiv);
        });

        optionsContainer.innerHTML = '';
        optionsContainer.appendChild(fragment);

        optionsContainer.querySelectorAll('.option').forEach(optionDiv => {
            optionDiv.classList.remove('correct', 'wrong', 'correct-answer', 'unanswered');
        });
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Shuffle only visible questions
    function shuffleVisibleQuestions() {
        const visibleIndexes = getVisibleQuestionIndexes();
        let visibleQuestions = visibleIndexes.map(i => quizData[i]);
        visibleQuestions = shuffleArray(visibleQuestions);

        for (let v = 0; v < visibleIndexes.length; v++) {
            quizData[visibleIndexes[v]] = visibleQuestions[v];
        }

        loadQuiz();
        applyAllFilters(); 
    }

    function shuffleAllOptions() {
        if (mode === 'mcq') {
            quizData.forEach((_, index) => {
                shuffleOptionsForQuestion(index);
            });
        }
    }

    function showIndividualAnswer(index) {
        if (mode === 'mcq') {
            const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);
            const options = document.querySelectorAll(`#options-container-${index} .option`);

            options.forEach(optionDiv => {
                optionDiv.classList.remove('correct', 'wrong', 'correct-answer', 'unanswered');
            });

            requestAnimationFrame(() => {
                options.forEach(optionDiv => {
                    const input = optionDiv.querySelector('input');
                    const optionIndex = parseInt(input.value);

                    if (optionIndex === quizData[index].answer) {
                        optionDiv.classList.add('correct-answer');
                    }

                    if (selectedOption) {
                        if (optionIndex === parseInt(selectedOption.value)) {
                            if (optionIndex === quizData[index].answer) {
                                optionDiv.classList.add('correct');
                            } else {
                                optionDiv.classList.add('wrong');
                            }
                        }
                    } else {
                        optionDiv.classList.add('unanswered');
                    }
                });
            });
        } else if (mode === 'flashcard') {
            toggleAnswer(index);
        }
    }

    function clearIndividualQuestion(index) {
        if (mode === 'mcq') {
            const options = document.querySelectorAll(`#options-container-${index} .option`);
            options.forEach(optionDiv => {
                optionDiv.classList.remove('correct', 'wrong', 'correct-answer', 'unanswered');
                const input = optionDiv.querySelector('input');
                input.checked = false;
            });
        } else if (mode === 'flashcard') {
            clearUserAnswer(index);
        }
    }

    function showResult() {
        showAllExplanations();
        const visibleIndexes = getVisibleQuestionIndexes();

        let score = 0;
        let unanswered = 0;
        let yesCount = 0;
        let noCount = 0;

        if (mode === 'mcq') {
            visibleIndexes.forEach(index => {
                const data = quizData[index];
                const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);
                const options = document.querySelectorAll(`#options-container-${index} .option`);

                options.forEach(optionDiv => {
                    optionDiv.classList.remove('correct', 'wrong', 'correct-answer', 'unanswered');
                });

                options.forEach(optionDiv => {
                    const input = optionDiv.querySelector('input');
                    const optionIndex = parseInt(input.value);
                    if (optionIndex === data.answer) {
                        optionDiv.classList.add('correct-answer');
                    }
                });

                if (selectedOption) {
                    const selectedValue = parseInt(selectedOption.value);
                    if (selectedValue === data.answer) {
                        score++;
                        selectedOption.parentNode.classList.add('correct');
                    } else {
                        selectedOption.parentNode.classList.add('wrong');
                    }
                } else {
                    unanswered++;
                    options.forEach(optionDiv => {
                        optionDiv.classList.add('unanswered');
                    });
                }
            });

            const total = visibleIndexes.length;
            const wrongAnswers = total - score - unanswered;
            resultElement.innerHTML = `
                <p>Your score is ${score} out of ${total}.</p>
                <p>Correct Answers: ${score}</p>
                <p>Wrong Answers: ${wrongAnswers}</p>
                <p>Unanswered Questions: ${unanswered}</p>
            `;

        } else if (mode === 'flashcard') {
            visibleIndexes.forEach(index => {
                const data = quizData[index];
                const answerDiv = document.getElementById(`answer-${index}`);
                if (answerDiv && (answerDiv.style.display === 'none' || answerDiv.style.display === '')) {
                    answerDiv.style.display = 'block';
                }

                if (data.userAnswer === 'yes') {
                    yesCount++;
                } else if (data.userAnswer === 'no') {
                    noCount++;
                } else {
                    unanswered++;
                }
            });

            const total = visibleIndexes.length;
            const score = yesCount;
            resultElement.innerHTML = `
                <p>Your Score:</p>
                <p>Correct (Yes): ${yesCount}</p>
                <p>Incorrect (No): ${noCount}</p>
                <p>Unanswered Questions: ${unanswered}</p>
                <p>Total visible Questions: ${total}</p>
            `;
        }

        addFilterButtons();
    }

    function addFilterButtons() {
        const oldContainer = document.getElementById('filter-container');
        if (oldContainer) oldContainer.remove();

        const filterContainer = document.createElement('div');
        filterContainer.id = 'filter-container';
        filterContainer.style.marginTop = '20px';
        filterContainer.style.display = 'flex';
        filterContainer.style.flexWrap = 'wrap';
        filterContainer.style.justifyContent = 'center';

        if (mode === 'mcq') {
            const showCorrectButton = document.createElement('button');
            showCorrectButton.textContent = 'Show Correct Answers';
            showCorrectButton.classList.add('filter-button', 'correct');
            showCorrectButton.style.marginRight = '10px';
            showCorrectButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'correct';
                applyAllFilters();
            });

            const showWrongButton = document.createElement('button');
            showWrongButton.textContent = 'Show Wrong Answers';
            showWrongButton.classList.add('filter-button', 'wrong');
            showWrongButton.style.marginRight = '10px';
            showWrongButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'wrong';
                applyAllFilters();
            });

            const showUnansweredButton = document.createElement('button');
            showUnansweredButton.textContent = 'Show Unanswered Questions';
            showUnansweredButton.classList.add('filter-button', 'unanswered');
            showUnansweredButton.style.marginRight = '10px';
            showUnansweredButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'unanswered';
                applyAllFilters();
            });

            const showAllButton = document.createElement('button');
            showAllButton.textContent = 'Show All Questions';
            showAllButton.classList.add('filter-button', 'all');
            showAllButton.style.marginRight = '10px';
            showAllButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'all';
                applyAllFilters();
            });

            filterContainer.appendChild(showCorrectButton);
            filterContainer.appendChild(showWrongButton);
            filterContainer.appendChild(showUnansweredButton);
            filterContainer.appendChild(showAllButton);
        } else if (mode === 'flashcard') {
            const showCorrectButton = document.createElement('button');
            showCorrectButton.textContent = 'Show Correct Answers';
            showCorrectButton.classList.add('filter-button', 'yes-button');
            showCorrectButton.style.marginRight = '10px';
            showCorrectButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'yes';
                applyAllFilters();
            });

            const showIncorrectButton = document.createElement('button');
            showIncorrectButton.textContent = 'Show Incorrect Answers';
            showIncorrectButton.classList.add('filter-button', 'no-button');
            showIncorrectButton.style.marginRight = '10px';
            showIncorrectButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'no';
                applyAllFilters();
            });

            const showUnansweredButton = document.createElement('button');
            showUnansweredButton.textContent = 'Show Unanswered Questions';
            showUnansweredButton.classList.add('filter-button', 'unanswered-button');
            showUnansweredButton.style.marginRight = '10px';
            showUnansweredButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'unanswered';
                applyAllFilters();
            });

            const showAllButton = document.createElement('button');
            showAllButton.textContent = 'Show All Questions';
            showAllButton.classList.add('filter-button', 'all-button');
            showAllButton.style.marginRight = '10px';
            showAllButton.addEventListener('click', () => {
                currentCorrectnessFilter = 'all';
                applyAllFilters();
            });

            filterContainer.appendChild(showCorrectButton);
            filterContainer.appendChild(showIncorrectButton);
            filterContainer.appendChild(showUnansweredButton);
            filterContainer.appendChild(showAllButton);
        }

        resultElement.appendChild(filterContainer);
    }

    function filterQuestionsCorrectness() {
        const visibleIndexesAfterCategory = getVisibleQuestionIndexesByCategory();

        visibleIndexesAfterCategory.forEach(index => {
            const questionContainer = document.getElementById(`question-container-${index}`);

            let shouldDisplay = false;

            if (mode === 'mcq') {
                const selectedOption = document.querySelector(`input[name="question-${index}"]:checked`);
                const data = quizData[index];
                if (currentCorrectnessFilter === 'correct') {
                    if (selectedOption && parseInt(selectedOption.value) === data.answer) {
                        shouldDisplay = true;
                    }
                } else if (currentCorrectnessFilter === 'wrong') {
                    if (selectedOption && parseInt(selectedOption.value) !== data.answer) {
                        shouldDisplay = true;
                    }
                } else if (currentCorrectnessFilter === 'unanswered') {
                    if (!selectedOption) {
                        shouldDisplay = true;
                    }
                } else {
                    shouldDisplay = true;
                }

            } else if (mode === 'flashcard') {
                const data = quizData[index];
                const ua = data.userAnswer;
                if (currentCorrectnessFilter === 'yes') {
                    if (ua === 'yes') shouldDisplay = true;
                } else if (currentCorrectnessFilter === 'no') {
                    if (ua === 'no') shouldDisplay = true;
                } else if (currentCorrectnessFilter === 'unanswered') {
                    if (!ua) shouldDisplay = true;
                } else {
                    shouldDisplay = true;
                }
            }

            questionContainer.style.display = shouldDisplay ? 'block' : 'none';
        });
    }

    function applyAllFilters() {
        const selectedOptions = categoryFilterSelected || [];
        quizData.forEach((data, index) => {
            const questionContainer = document.getElementById(`question-container-${index}`);
            const category = extractCategoryFromQuestion(data.question);
            if (selectedOptions.length === 0 || selectedOptions.includes(category)) {
                questionContainer.style.display = 'block';
            } else {
                questionContainer.style.display = 'none';
            }
        });

        filterQuestionsCorrectness();
        renumberVisibleQuestions();
        const visibleCount = getVisibleQuestionIndexes().length;
        document.getElementById('total-questions').textContent = visibleCount;
    }

    function renumberVisibleQuestions() {
        const visibleIndexes = getVisibleQuestionIndexes();
        visibleIndexes.forEach((index, i) => {
            const questionNumberSpan = document.querySelector(`#question-container-${index} .question-number`);
            if (questionNumberSpan) {
                questionNumberSpan.textContent = (i + 1) + ".";
            }
        });
    }

    function getVisibleQuestionIndexes() {
        const containers = document.querySelectorAll('.question-container');
        const visibleIndexes = [];
        containers.forEach((c, i) => {
            if (c.style.display !== 'none') {
                visibleIndexes.push(i);
            }
        });
        return visibleIndexes;
    }

    function getVisibleQuestionIndexesByCategory() {
        const selectedOptions = categoryFilterSelected || [];
        const indexes = [];
        quizData.forEach((data, i) => {
            const category = extractCategoryFromQuestion(data.question);
            if (selectedOptions.length === 0 || selectedOptions.includes(category)) {
                indexes.push(i);
            }
        });
        return indexes;
    }

    function openResetModal() {
        document.getElementById('reset-modal').style.display = 'block';
    }

    function closeResetModal() {
        document.getElementById('reset-modal').style.display = 'none';
    }

    function confirmResetQuiz() {
        quizData = JSON.parse(JSON.stringify(originalQuizData));
        loadQuiz();
        requestAnimationFrame(() => {
            resultElement.innerHTML = '';
            scrollState = 0;
            lastAnsweredIndex = -1;
            updateScrollButtonIcon();
            currentCorrectnessFilter = 'all';
            categoryFilterSelected = [];
            applyAllFilters();
            closeResetModal();
        });
    }

    function resetQuiz() {
        openResetModal();
    }

    function openJumpModal() {
        document.getElementById('jump-modal').style.display = 'block';
        document.getElementById('jump-input').focus();
    }

    function closeJumpModal() {
        document.getElementById('jump-modal').style.display = 'none';
        clearSearchResults();
    }

    function displaySearchResults(results) {
        const searchResultsContainer = document.getElementById('search-results');
        searchResultsContainer.innerHTML = '';

        if (results.length === 0) {
            const noResults = document.createElement('p');
            noResults.textContent = 'No matching questions found.';
            searchResultsContainer.appendChild(noResults);
        } else {
            const resultsList = document.createElement('ul');

            results.forEach(result => {
                const listItem = document.createElement('li');

                const resultButton = document.createElement('button');
                resultButton.innerHTML = `Question ${result.index + 1}: ${result.questionSnippet}`;
                resultButton.addEventListener('click', () => {
                    document.getElementById(`question-${result.index}`).scrollIntoView({ behavior: 'smooth' });
                    closeJumpModal();
                });

                listItem.appendChild(resultButton);
                resultsList.appendChild(listItem);
            });

            searchResultsContainer.appendChild(resultsList);
        }
    }

    function clearSearchResults() {
        const searchResultsContainer = document.getElementById('search-results');
        searchResultsContainer.innerHTML = '';
    }

    function stripHTML(html) {
        let div = document.createElement('div');
        div.innerHTML = html;
        return div.textContent || div.innerText || '';
    }

    function highlightTerm(text, term) {
        const regex = new RegExp(`(${term})`, 'gi');
        return text.replace(regex, '<mark>$1</mark>');
    }

    function jumpToQuestion() {
        const input = document.getElementById('jump-input').value.trim();
        if (input === '') return;

        const visibleIndexes = getVisibleQuestionIndexes();
        const results = [];

        if (isNaN(input)) {
            for (let j = 0; j < visibleIndexes.length; j++) {
                const i = visibleIndexes[j];
                const data = quizData[i];
                const questionText = stripHTML(data.question);
                if (questionText.toLowerCase().includes(input.toLowerCase())) {
                    results.push({
                        index: i,
                        questionSnippet: highlightTerm(questionText, input),
                    });
                }
            }
        } else {
            const num = parseInt(input);
            const idx = num - 1;
            if (visibleIndexes.includes(idx)) {
                results.push({
                    index: idx,
                    questionSnippet: `Question ${num}`
                });
            }
        }

        displaySearchResults(results);
    }

    function toggleAnswer(index) {
        const answerDiv = document.getElementById(`answer-${index}`);
        if (!answerDiv) return;
        if (answerDiv.style.display === 'none' || answerDiv.style.display === '') {
            answerDiv.style.display = 'block';
        } else {
            answerDiv.style.display = 'none';
        }
    }

    function setUserAnswer(index, answer) {
        quizData[index].userAnswer = answer;
        lastAnsweredIndex = index;
        updateScrollButtonIcon();
        updateIndicator(index, answer);
    }

    function updateIndicator(index, answer) {
        const indicator = document.getElementById(`indicator-${index}`);
        if (!indicator) return;
        if (answer === 'yes') {
            indicator.innerHTML = '✔️';
        } else if (answer === 'no') {
            indicator.innerHTML = '❌';
        }
    }

    function clearUserAnswer(index) {
        quizData[index].userAnswer = null;
        const indicator = document.getElementById(`indicator-${index}`);
        if (indicator) indicator.innerHTML = '';
        const answerDiv = document.getElementById(`answer-${index}`);
        if (answerDiv) answerDiv.style.display = 'none';
    }

    function extractCategoryFromQuestion(questionHTML) {
        const div = document.createElement('div');
        div.innerHTML = questionHTML;
        const span = div.querySelector('span[style*="darkred"]');
        if (span) {
            let text = span.textContent.trim();
            const questionIndex = text.toLowerCase().indexOf('question');
            if (questionIndex !== -1) {
                text = text.substring(0, questionIndex).trim();
                text = text.replace(/\-\s*$/, '').trim();
            }
            return text;
        }
        return '';
    }

    function updateCategoryFilter() {
        const categorySelect = document.getElementById('category-filter');
        categorySelect.innerHTML = '';

        // Use originalCategories for stable category listing
        originalCategories.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            if (categoryFilterSelected.includes(cat)) {
                option.selected = true;
            }
            categorySelect.appendChild(option);
        });
    }

    function openCategoryModal() {
        document.getElementById('category-modal').style.display = 'block';
        updateCategoryFilter();
    }

    function closeCategoryModal() {
        document.getElementById('category-modal').style.display = 'none';
    }

    function applyCategoryFilter() {
        const categorySelect = document.getElementById('category-filter');
        categoryFilterSelected = Array.from(categorySelect.selectedOptions).map(o => o.value);
        closeCategoryModal();
        applyAllFilters();
    }

    document.getElementById('select-all-categories-btn').addEventListener('click', () => {
        const categorySelect = document.getElementById('category-filter');
        const allSelected = Array.from(categorySelect.options).every(option => option.selected);
        for (let i = 0; i < categorySelect.options.length; i++) {
            categorySelect.options[i].selected = !allSelected;
        }
    });

    function showAllExplanations() {
        const visibleIndexes = getVisibleQuestionIndexes();
        visibleIndexes.forEach(index => {
            const explanationDiv = document.getElementById(`explanation-${index}`);
            if (explanationDiv) {
                explanationDiv.style.display = 'block';
            }
        });
    }

    initOriginalCategories();
    loadQuiz();
    updateScrollButtonIcon();
    categoryFilterSelected = [];
    applyAllFilters();
    </script>
</body>
</html>
